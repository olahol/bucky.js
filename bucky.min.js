(function(){var n,t,e=[].slice;t=function(n,t,e){var r,o,a,i,u,f,s;u=0;r=0;o=new FormData;for(i in t){f=t[i];o.append(i,f)}o.append("file",e);s=new XMLHttpRequest;s.onreadystatechange=function(){var n;if(s.readyState===4){if(s.statusText!=="OK"){return a.fail(e,t.key)}n=u-r;if(n!==0){a.progress(n)}return a.done(e,t.key)}};s.upload.addEventListener("abort",function(n){return a.fail(e,t.key)});s.upload.addEventListener("error",function(n){return a.fail(e,t.key)});s.upload.addEventListener("progress",function(n){if(r===0){u=n.total;a.start(u)}a.progress(n.loaded-r);return r=n.loaded});s.open("POST",n,true);s.send(o);return a={start:function(){},fail:function(){},progress:function(){},done:function(){}}};n=function(){var n,r,o,a,i,u,f,s;n=arguments[0],o=2<=arguments.length?e.call(arguments,1):[];u=function(e){var r,o,i,u,f,s,d,c;f=0;u=0;r=0;i=e.target.files||e.dataTransfer.files;a.start();c=[];for(s=0,d=i.length;s<d;s++){o=i[s];c.push(a.policy(o,function(e){var s;s=t("http://"+n+".s3.amazonaws.com",e,o);s.start=function(n){return f+=n};s.progress=function(n){u+=n;return a.progress(u,f)};s.fail=function(n,t){r+=1;a.fail(n,t);if(r===i.length){return a.stop()}};return s.done=function(n,t){r+=1;a.done(n,t);if(r===i.length){return a.stop()}}}))}return c};i=function(n){var t;t=function(n){n.stopPropagation();return n.preventDefault()};if(n.nodeName==="INPUT"){return n.addEventListener("change",u)}else{n.addEventListener("dragover",t);n.addEventListener("dragleave",t);return n.addEventListener("drop",function(n){t(n);return u(n)})}};for(f=0,s=o.length;f<s;f++){r=o[f];i(r)}return a={start:function(){},policy:function(){},progress:function(){},fail:function(){},done:function(){},stop:function(){}}};window.bucky=n}).call(this);
